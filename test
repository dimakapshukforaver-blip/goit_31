import pandas as pd
import requests
import time

def fetch_data_from_api(url, params=None, max_retries=3, backoff_factor=0.3):
    """Fetch data from a REST API with retry logic."""
    for attempt in range(max_retries):
        try:
            response = requests.get(url, params=params)
            response.raise_for_status()  # Raise an error for bad responses
            return response.json()
        except requests.RequestException as e:
            print(f"Attempt {attempt + 1} failed: {e}")
            if attempt < max_retries - 1:
                time.sleep(backoff_factor * (2 ** attempt))  # Exponential backoff
            else:
                raise 
    return None
def json_to_dataframe(json_data):
    """Convert JSON data to a pandas DataFrame."""
    return pd.json_normalize(json_data) 
def main():
    api_url = "https://api.example.com/data"
    params = {"param1": "value1", "param2": "value2"}

    try:
        json_data = fetch_data_from_api(api_url, params)
        df = json_to_dataframe(json_data)
        print(df.head())
    except Exception as e:
        print(f"Failed to fetch or process data: {e}")
if __name__ == "__main__":
    main() 
"""A script to fetch data from a REST API and convert it to a pandas DataFrame."""